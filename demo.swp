' SOLIDWORKS VBA Macro
' Description: Otomatik olarak "YUSUF" yazılı bir anahtarlık oluşturur.

Option Explicit

Dim swApp As SldWorks.SldWorks
Dim swModel As SldWorks.ModelDoc2
Dim swPart As SldWorks.PartDoc
Dim boolstatus As Boolean

Sub main()

    ' --- Parametreler ---
    Const ANAHTARLIK_UZUNLUK As Double = 0.06   ' 60 mm
    Const ANAHTARLIK_GENISLIK As Double = 0.025 ' 25 mm
    Const ANAHTARLIK_KALINLIK As Double = 0.003 ' 3 mm
    Const DELIK_CAP As Double = 0.004           ' 4 mm
    Const YAZI_METNI As String = "YUSUF"
    Const YAZI_DERINLIK As Double = 0.001       ' 1 mm

    ' SOLIDWORKS uygulamasını al
    Set swApp = Application.SldWorks
    If swApp Is Nothing Then
        MsgBox "SOLIDWORKS çalışmıyor. Lütfen önce SOLIDWORKS'ü başlatın."
        Exit Sub
    End If

    ' Yeni parça oluştur
    Set swModel = swApp.NewPart
    If swModel Is Nothing Then
        MsgBox "Yeni parça oluşturulamadı."
        Exit Sub
    End If

    Set swPart = swModel

    ' -------------------------------
    ' 1. Anahtarlık gövdesi
    ' -------------------------------

    boolstatus = swModel.Extension.SelectByID2("Front Plane", "PLANE", 0, 0, 0, False, 0, Nothing, 0)
    swModel.SketchManager.InsertSketch True
    
    ' Dikdörtgen çiz (slot yerine basit rectangle)
    Dim x1 As Double, y1 As Double, x2 As Double, y2 As Double
    x1 = -ANAHTARLIK_UZUNLUK / 2
    y1 = -ANAHTARLIK_GENISLIK / 2
    x2 = ANAHTARLIK_UZUNLUK / 2
    y2 = ANAHTARLIK_GENISLIK / 2
    swModel.SketchManager.CreateCornerRectangle x1, y1, 0, x2, y2, 0
    
    swModel.SketchManager.InsertSketch True
    swModel.FeatureManager.FeatureExtrusion2 True, False, False, 0, 0, ANAHTARLIK_KALINLIK, 0, False, False, False, False, 0, 0, False, False, False, False

    swModel.ClearSelection2 True

    ' -------------------------------
    ' 2. Anahtarlık deliği
    ' -------------------------------
    boolstatus = swModel.Extension.SelectByID2("Top Plane", "PLANE", 0, 0, 0, False, 0, Nothing, 0)
    swModel.SketchManager.InsertSketch True

    Dim delikX As Double, delikY As Double
    delikX = -ANAHTARLIK_UZUNLUK / 2 + ANAHTARLIK_GENISLIK / 2
    delikY = 0
    swModel.SketchManager.CreateCircleByRadius delikX, delikY, 0, DELIK_CAP / 2

    swModel.SketchManager.InsertSketch True
    swModel.FeatureManager.FeatureCut2 True, False, False, 0, 0, ANAHTARLIK_KALINLIK + 0.001, 0, False, False, False, False, 0, 0, False, False, False, False

    swModel.ClearSelection2 True

    ' -------------------------------
    ' 3. Yazı ekleme
    ' -------------------------------
    boolstatus = swModel.Extension.SelectByID2("Front Plane", "PLANE", 0, 0, 0, False, 0, Nothing, 0)
    swModel.SketchManager.InsertSketch True

    Dim skText As SldWorks.SketchText
    ' Yazıyı ortalamak için yaklaşık koordinatlar
    Set skText = swModel.SketchManager.InsertSketchText(YAZI_METNI, -0.015, 0, 0, 0.008, "Arial", False, False, 0, False, False)

    swModel.SketchManager.InsertSketch True
    swModel.FeatureManager.FeatureCut2 True, False, False, 0, 0, YAZI_DERINLIK, 0, False, False, False, False, 0, 0, False, False, False, False

    swModel.ClearSelection2 True

    ' Modeli ekrana sığdır
    swModel.ViewZoomtofit2

    MsgBox "Anahtarlık başarıyla oluşturuldu!"

End Sub
